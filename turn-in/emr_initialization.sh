aws emr create-cluster --name "cluster" --applications Name=Hadoop Name=Hive Name=Pig Name=Hue Name=Spark --ec2-attributes '{"KeyName":"colin_key","InstanceProfile":"EMR_EC2_DefaultRole"}' --release-label emr-6.3.0 --log-uri 's3n://aws-logs-cluster-us-west-2/elasticmapreduce/' --instance-type m5.xlarge --instance-count 3 --configurations '[{"Classification":"spark-hive-site","Properties":{"hive.metastore.client.factory.class":"com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory"}}]' --auto-scaling-role EMR_AutoScaling_DefaultRole --ebs-root-volume-size 10 --service-role EMR_DefaultRole --enable-debugging --scale-down-behavior TERMINATE_AT_TASK_COMPLETION --steps Type=Spark,Name="Spark application",ActionOnFailure=CONTINUE,Args=[--deploy-mode,cluster,--master,yarn,s3://ds102-dsc01-scratch/label_prep.py] Type=Spark,Name="Spark application",ActionOnFailure=CONTINUE,Args=[--deploy-mode,cluster,--master,yarn,s3://ds102-dsc01-scratch/model.py] --region us-west-2 --auto-terminate